define(["base/base"], function(base){
	FwBase.Wtf.View.Controls.Thumbnails = function(){
		FwBase.Wtf.View.Controls.BaseControl.apply(this, arguments);
	};
	
	$.extend(FwBase.Wtf.View.Controls.Thumbnails.prototype, FwBase.Wtf.View.Controls.BaseControl.prototype, 
		{
			template: _.template($('#sys_atom_controls_thumbnails').html()),
			postInit : function(){
				this.model = $app.model(this.metadata.model);
				if(this.model){
					this.listenTo(this.model, "clear", this.clearPage);
					this.listenTo(this.model, "add", this.addRow);
					this.listenTo(this.model, "remove", this.deleteRow);
					this.listenTo(this.model, "change", this.changeRow);
				}
				this.thumbnails = this.el.children('#thumbnails');
				
				if(this.metadata.mock){
					this.doAddRow({title : 'Thumbnail1', value : 'Thumbnail1'});
					this.doAddRow({title : 'Thumbnail2', value : 'Thumbnail2'});
				}
			},
			mockMetadata : function(){
				this.setDefault({mock : true});
			},
			makeDefault : function(){
				this.setDefault({binding: {id: 'id', title : null, value : 'value'}});
			},
			addRow : function(obj) {
				var row = obj.row.toJSON();
				this.doAddRow(row);
			},
			doAddRow : function(row) {
				var value = row[this.metadata.binding.value];
				//just for the demo
				if(value == null)
					value = row['startip'];
				if(value == null)
					value = row['user'];
				var str = '<li class="span4"><div class="thumbnail"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAZAAAAGQCAYAAACAvzbMAAASVElEQVR4Xu3dQWvTaRfG4bgQceFScSsuFbeKH9+VK3Gpa8VlVyKIqEMKGTJ/0za9TxI7va+BlxemPWme6zz4I2nt3Dk7O/u98g8BAgQIELimwB0BuaaYTydAgACBcwEBcREIECBAIBIQkIjNEAECBAgIiDtAgAABApGAgERshggQIEBAQNwBAgQIEIgEBCRiM0SAAAECAuIOECBAgEAkICARmyECBAgQEBB3gAABAgQiAQGJ2AwRIECAgIC4AwQIECAQCQhIxGaIAAECBATEHSBAgACBSEBAIjZDBAgQICAg7gABAgQIRAICErEZIkCAAAEBcQcIECBAIBIQkIjNEAECBAgIiDtAgAABApGAgERshggQIEBAQNwBAgQIEIgEBCRiM0SAAAECAuIOECBAgEAkICARmyECBAgQEBB3gAABAgQiAQGJ2AwRIECAgIC4AwQIECAQCQhIxGaIAAECBATEHSBAgACBSEBAIjZDBAgQICAg7gABAgQIRAICErEZIkCAAAEBcQcIECBAIBIQkIjNEAECBAgIiDtAgAABApGAgERshggQIEBAQNwBAgQIEIgEBCRiM0SAAAECAuIOECBAgEAkICARmyECBAgQEBB3gAABAgQiAQGJ2AwRIECAgIC4AwQIECAQCQhIxGaIAAECBATEHSBAgACBSEBAIjZDBAgQICAg7gABAgQIRAICErEZIkCAAAEBcQcIECBAIBIQkIjNEAECBAgIiDtAgAABApGAgERshggQIEBAQNwBAgQIEIgEBCRiM0SAAAECAuIOECBAgEAkICARmyECBAgQEBB3gAABAgQiAQGJ2AwRIECAgIC4AwQIECAQCQhIxGaIAAECBATEHSBAgACBSEBAIjZDBAgQICAg7gABAgQIRAICErEZIkCAAAEBcQcIECBAIBIQkIjNEAECBAgIiDtAgAABApGAgERshggQIEBAQNwBAgQIEIgEBCRiM0SAAAECAuIOECBAgEAkICARmyECBAgQEBB3gAABAgQiAQGJ2AwRIECAgIC4AwQIECAQCQhIxGaIAAECBATEHSBAgACBSEBAIjZDBAgQICAg7gABAgQIRAICErEZIkCAAAEBcQcIECBAIBIQkIjNEAECBAgIiDtAgAABApGAgERshggQIEBAQNwBAgQIEIgEBCRiM0SAAAECAuIOECBAgEAkICARmyECBAgQEBB3gAABAgQiAQGJ2AwRIECAgIC4AwQIECAQCQhIxGaIAAECBATEHSBAgACBSEBAIjZDBAgQICAg7gABAgQIRAICErEZIkCAAAEBcQcIECBAIBIQkIjNEAECBAgIiDtAgAABApGAgERshggQIEBAQNwBAgQIEIgEBCRiM0SAAAECAuIOECBAgEAkICARmyECBAgQEBB3gAABAgQiAQGJ2AwRIECAgIC4AwQIECAQCQhIxGaIAAECBATEHSBAgACBSEBAIjZDBAgQICAg7gABAgQIRAICErEZIkCAAAEBcQcIECBAIBIQkIjNEAECBAgIiDtAgAABApGAgERshggQIEBAQNwBAgQIEIgEBCRiM0SAAAECAuIOECBAgEAkICARmyECBAgQEBB3gAABAgQiAQGJ2AwRIECAgIC4AwQIECAQCQhIxGaIAAECBATEHSBAgACBSEBAIjZDBAgQICAg7gABAgQIRAICErEZIkCAAAEBcQcIECBAIBIQkIjNEAECBAgIiDtAgAABApGAgERshggQIEBAQNwBAgQIEIgEBCRiM0SAAAECAuIOECBAgEAkICARmyECBAgQEBB3gAABAgQiAQGJ2AwRIECAgIC4AwQIECAQCQhIxGaIAAECBATEHSBAgACBSEBAIjZDBAgQICAg7gABAgQIRAICErEZIkCAAAEBcQcIECBAIBIQkIjNEAECBAgIiDtAgAABApGAgERshggQIEBAQNwBAgQIEIgEBCRiM0SAAAECAuIOECBAgEAkICARmyECBAgQEBB3gAABAgQiAQGJ2AwRIECAgIC4AwQIECAQCQhIxGaIAAECBATEHSBAgACBSEBAIjZDBAgQICAg7gABAgQIRAICErEZIkCAAAEBcQcIECBAIBIQkIjNEAECBAgIiDtAgAABApGAgERshggQIEBAQNwBAgQIEIgEBCRiM0SAAAECAuIOECBAgEAkICARmyECBAgQEBB3gAABAgQiAQGJ2AwRIECAgIC4AwQIECAQCQhIxGaIAAECBATEHSBAgACBSEBAIjZDBAgQICAg7gABAgQIRAICErEZIkCAAAEBcQcIECBAIBIQkIjNEAECBAgIiDtAgAABApGAgERshggQIEBAQNwBAgQIEIgEBCRiM0SA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" alt="">';
							if(this.metadata.binding.title)
								str += '<h3>' + row[this.metadata.binding.title] + '</h3>';
							if(this.metadata.binding.value)
								str += '<p>' + value + '</p>';
							str += '</div></li>';
				this.thumbnails.append(str);
			}
		}
	);
	return FwBase.Wtf.View.Controls.Thumbnails;
});